function [h, h_s] = enthalpy(varargin) % enthalpy (h) and sensible enthalpy(h_s), if species and flow are provided it returns H (total enthalpy(kW)) and H_s Sensible enthalpy (kW).
Ru = 8.314;
T = varargin{1};
X =[];
if length(varargin)>1
    X = varargin{2};
    N = varargin{3};
end
n = length(T);
h = zeros(n,7);
CH4a = [2.1737833; 8.9936592e-3; -2.7855467e-6; 3.9775117e-10; -1.9976425e-14; -1.0216566e4];
CH4b = [2.9428148; 2.5153728e-3; 7.9085839e-6; -4.7495483e-9; 1.4244910e-13; -1.0056824e4;];

COa = [3.025178; 1.4426885e-3; -5.630827e-7; 1.0185813e-10; -6.91095e-15; -1.426835e4;];
COb = [3.262451; 1.5119409e-3; -3.881755e-6; 5.581944e-9; -2.474951e-12; -1.4310539e4;];

CO2a = [4.453623; 3.140168e-3; -1.2784105e-6; 2.393996e-10; -1.6690333e-14; -4.896696e4;];
CO2b = [2.275724; 9.922072e-3; -1.0409113e-5; 6.866686e-9; -2.117280e-12; -4.837314e4];

H2a = [2.991423; 7.000644e-4; -5.633828e-8; -9.231578e-12; 1.5827519e-15; -8.350340e2;];
H2b = [3.298124; 8.249441e-4; -8.143015e-7; -9.475434e-11; 4.134872e-13; -1.0125209e3;];

H2Oa = [2.672145; 3.056293e-3; -8.730260e-7; 1.2009964e-10; -6.391618e-15; -2.989921e4;];
H2Ob = [3.386842; 3.474982e-3; -6.354696e-6; 6.968581e-9; -2.506588e-12; -3.020811e4;];

N2a = [2.926640; 1.4879768e-3; -5.684760e-7; 1.0097038e-10; -6.753351e-15; -9.227977e2;];
N2b = [3.298677; 1.4082404e-3; -3.963222e-6; 5.64151e-9; -2.444854e-12; -1.0208999e3;];

O2a = [3.697578; 6.135197e-4; -1.258842e-7; 1.775281e-11; -1.1364354e-15; -1.2339301e3;];
O2b = [3.212936; 1.1274864e-3; -5.756150e-7; 1.3138773e-9; -8.768554e-13; -1.0052490e3;];

T2 = (T.^2)/2; 
T3 = (T.^3)/3; 
T4 = (T.^4)/4;
T5 = (T.^5)/5; 
T6 = linspace(1,1,n);
for i=1:1:n
    if T(i)>=1000
        h(i,1) = sum([T(i)*CH4a(1); T2(i)*CH4a(2); T3(i)*CH4a(3); T4(i)*CH4a(4); T5(i)*CH4a(5); T6(i)*CH4a(6);]);
        h(i,2) = sum([T(i)*COa(1); T2(i)*COa(2); T3(i)*COa(3); T4(i)*COa(4); T5(i)*COa(5); T6(i)*COa(6);]);
        h(i,3) = sum([T(i)*CO2a(1); T2(i)*CO2a(2); T3(i)*CO2a(3); T4(i)*CO2a(4); T5(i)*CO2a(5); T6(i)*CO2a(6);]);
        h(i,4) = sum([T(i)*H2a(1); T2(i)*H2a(2); T3(i)*H2a(3); T4(i)*H2a(4); T5(i)*H2a(5); T6(i)*H2a(6);]);
        h(i,5) = sum([T(i)*H2Oa(1); T2(i)*H2Oa(2); T3(i)*H2Oa(3); T4(i)*H2Oa(4); T5(i)*H2Oa(5); T6(i)*H2Oa(6);]);
        h(i,6) = sum([T(i)*N2a(1); T2(i)*N2a(2); T3(i)*N2a(3); T4(i)*N2a(4); T5(i)*N2a(5); T6(i)*N2a(6);]);
        h(i,7) = sum([T(i)*O2a(1); T2(i)*O2a(2); T3(i)*O2a(3); T4(i)*O2a(4); T5(i)*O2a(5); T6(i)*O2a(6);]);
    else
        h(i,1) = sum([T(i)*CH4b(1); T2(i)*CH4b(2); T3(i)*CH4b(3); T4(i)*CH4b(4); T5(i)*CH4b(5); T6(i)*CH4b(6);]);
        h(i,2) = sum([T(i)*COb(1); T2(i)*COb(2); T3(i)*COb(3); T4(i)*COb(4); T5(i)*COb(5); T6(i)*COb(6);]);
        h(i,3) = sum([T(i)*CO2b(1); T2(i)*CO2b(2); T3(i)*CO2b(3); T4(i)*CO2b(4); T5(i)*CO2b(5); T6(i)*CO2b(6);]);
        h(i,4) = sum([T(i)*H2b(1); T2(i)*H2b(2); T3(i)*H2b(3); T4(i)*H2b(4); T5(i)*H2b(5); T6(i)*H2b(6);]);
        h(i,5) = sum([T(i)*H2Ob(1); T2(i)*H2Ob(2); T3(i)*H2Ob(3); T4(i)*H2Ob(4); T5(i)*H2Ob(5); T6(i)*H2Ob(6);]);
        h(i,6) = sum([T(i)*N2b(1); T2(i)*N2b(2); T3(i)*N2b(3); T4(i)*N2b(4); T5(i)*N2b(5); T6(i)*N2b(6);]);
        h(i,7) = sum([T(i)*O2b(1); T2(i)*O2b(2); T3(i)*O2b(3); T4(i)*O2b(4); T5(i)*O2b(5); T6(i)*O2b(6);]);
    end
end
h = h*Ru;
h_s = [h(:,1)+74850, h(:,2)+110530, h(:,3)+393520, h(:,4), h(:,5)+241820, h(:,6), h(:,7)];

if ~isempty(X);
    h = sum(h.*X,2).*N;
    h_s = sum(h_s.*X,2).*N;
end